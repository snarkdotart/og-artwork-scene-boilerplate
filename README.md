# OG Artwork Scene Boilerplate

This is a project boilerplate for OG Artwork Scene.

## Requirements

- Node.js
- npm

## Getting Started

First, clone the repository:

```bash
git clone https://github.com/snarkdotart/og-artwork-scene-boilerplate.git
cd og-artwork-scene-boilerplate
```

Then install dependencies:

```bash
npm install
```

## Development
To start the development server, run:
```bash
npm run dev
```

## Building
To build the project, use:
```bash
npm run build
```
This will generate a dist directory with the built assets.

## Packaging
To package the built assets into a zip file, use:
```bash
npm run publish
```
This will create a output/dist.zip and output/traits.js file. This files can be uploaded to the OG Studio.
    
## Previewing
To preview the build, run:
```bash
npm run preview
```

## Trait Generation

onGenerateTokenState is the main function that gets invoked on every generate request
It returns the new state of a token and takes the current state as an input object
Be careful with returning big integer values they may be stored incorrectly, better use strings

input - an object that represents the current state of a token
- token_id - ID of the token
- generation - integer value, increases after every render request. 0 - just minted token
- seed - a hex value, unique to every token e.g. "0x3f13cb3..."
- traits - a key-value object of publicly available values
- properties - a key-value object of privately available values

```typescript
interface Input {
    token_id: string;
    generation: number;
    seed: string;
    traits: Record<string, any>;
    properties: Record<string, any>;
}
```

The function then returns a new state object with the updated generation boolean, traits, and properties.
Simple example of generation traits can be found in src/traits.js:
```javascript
function onGenerateTokenState(input) {
    let seed = BigInt(input.seed);
    const colorRandom = seededRandom(seed);
    seed++;
    const shapeRandom = seededRandom(seed * 2n);
    seed++;
    const sizeRandom = seededRandom(seed * 3n);

    const color = getValue(colorRandom, colorTraits);
    const shape = getValue(shapeRandom, shapeProperties);
    const size = getValue(sizeRandom, sizeTraits);
    const needsNewGeneration = input.generation % 5 === 0;

    const newState = {
        newGeneration: needsNewGeneration,
        traits: {
            color: color,
            size: size,
        },
        properties: {
            generation: input.generation,
            seed: input.seed,
            shape: shape,
        },
    };

    return newState;
}
```
## Trait Object
output of onGenerateTokenState function should be a trait object with the following structure:
```json
{
    "traits": {
        "color": "Blue"
    },
    "properties": {
        "shape": "Star"
    }
}
```
This object will be passed to the renderFunction.

## Rendering
You are encouraged to create your own rendition of the renderFunction. A basic example to guide you can be found in src/renderFunction.js:
```javascript
const renderFunction = (data, canvas) => {
  const ctx = canvas.getContext("2d");
  renderGradientBackground(ctx, canvas);
  renderText(ctx, data);
  renderShape(ctx, data);

  if (typeof window.render_completed === "function") {
    window.render_completed();
  }
};
```

## Rendering Data
The data object passed to the renderFunction contains the traits and properties (including seed) generated by onGenerateTokenState function:
```json
{
  "traits": {
    "color": "Yellow"
  },
  "properties": {
    "shape": "Square",
    "seed": 9515559
  }
}
```

## Assets
You can add your own assets to the project. The assets directory is located in src/public. You can add images, fonts, etc. to this directory and use them in your renderFunction.
In example below, we are using an array of image paths to render the shape. Images located in src/public/images directory:

```javascript
// Array of image paths
const imageNames = ['/images/beauty_010.png', '/images/beauty_030.png', '/images/beauty_050.png', '/images/beauty_070.png', '/images/beauty_090.png'];
const renderShape = (data) => {
    const gen = data.traits.Generation || 0;

    // Create new image element
    const img = document.createElement('img');

    // Set the image source
    img.src = imageNames[gen % imageNames.length];

    // Append the image to the body of the document
    document.body.appendChild(img);
};
```
